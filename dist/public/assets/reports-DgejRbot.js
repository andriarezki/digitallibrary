import{j as e}from"./ui-DM3Dsx1x.js";import{r as t}from"./vendor-C1mj56OW.js";import{e as s,F as o}from"./index-C2B3YKz3.js";import{E as a,a as l}from"./pdf-QG3cfAWJ.js";import"./query-DVbHB3bz.js";import"./charts-CWC3ycSS.js";function i(){const[i,r]=t.useState(null),[n,d]=t.useState([]),[c,x]=t.useState(!0);t.useEffect(()=>{!async function(){x(!0);const e=await fetch("/api/dashboard/stats",{credentials:"include"}),t=await e.json();r(t);const s=await fetch("/api/dashboard/top-categories",{credentials:"include"}),o=await s.json();d(o),x(!1)}()},[]);return e.jsxs("div",{className:"min-h-screen",children:[e.jsx("div",{className:"bg-white border-b border-slate-200 px-6 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900",children:"Reports"}),e.jsxs(s,{className:"bg-primary text-white px-4 py-2 rounded-lg text-sm font-medium hover:bg-blue-700 transition-colors",onClick:()=>{if(!i)return;const e=new a;e.setFontSize(18),e.text("Library Report",20,20),e.setFontSize(12),e.text(`Generated at: ${(new Date).toLocaleString()}`,20,30),e.setFontSize(14),e.text("Summary:",20,45),e.setFontSize(12),e.text(`Total Books: ${i.totalBooks}`,30,55),e.text(`Available Books: ${i.availableBooks}`,30,62),e.text(`Borrowed Books: ${i.borrowedBooks??i.totalBooks-i.availableBooks}`,30,69),e.text(`Total Users: ${i.totalUsers}`,30,76),e.text(`Total Categories: ${i.totalCategories}`,30,83),e.text(`Total Locations: ${i.totalLocations}`,30,90),e.setFontSize(14),e.text("Top Categories:",20,105),l(e,{startY:110,head:[["#","Category","Book Count"]],body:n.map((e,t)=>[t+1,e.name,e.count]),theme:"grid",headStyles:{fillColor:[41,128,185]},styles:{fontSize:11}}),e.save("library-report.pdf")},disabled:c||!i,children:[e.jsx(o,{className:"w-4 h-4 mr-2"}),"Generate Report"]})]})}),e.jsx("div",{className:"p-6",children:c?e.jsx("div",{className:"text-center py-12 text-slate-500",children:"Loading report data..."}):e.jsxs("div",{className:"max-w-lg mx-auto bg-white rounded-lg shadow p-6",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Library Summary"}),e.jsxs("ul",{className:"mb-4 space-y-1",children:[e.jsxs("li",{children:["Total Books: ",e.jsx("b",{children:null==i?void 0:i.totalBooks})]}),e.jsxs("li",{children:["Available Books: ",e.jsx("b",{children:null==i?void 0:i.availableBooks})]}),e.jsxs("li",{children:["Borrowed Books: ",e.jsx("b",{children:(null==i?void 0:i.borrowedBooks)??((null==i?void 0:i.totalBooks)||0)-((null==i?void 0:i.availableBooks)||0)})]}),e.jsxs("li",{children:["Total Users: ",e.jsx("b",{children:null==i?void 0:i.totalUsers})]}),e.jsxs("li",{children:["Total Categories: ",e.jsx("b",{children:null==i?void 0:i.totalCategories})]}),e.jsxs("li",{children:["Total Locations: ",e.jsx("b",{children:null==i?void 0:i.totalLocations})]})]}),e.jsx("h3",{className:"font-semibold mb-2",children:"Top Categories"}),e.jsx("ol",{className:"list-decimal list-inside",children:n.map(t=>e.jsxs("li",{children:[t.name," (",t.count," books)"]},t.id))})]})})]})}export{i as default};
