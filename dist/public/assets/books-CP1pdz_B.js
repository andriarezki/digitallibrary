import{j as e,o as s,p as a,T as t,I as l,q as i,r,s as n,t as d,v as o,L as c,w as m,x,y as h,z as p,a as u,E as j,F as g,O as b,u as f,W as N,G as v,f as y,H as k,J as w,K as _,M as C,N as S,n as A}from"./ui-B2QfF1wH.js";import{r as D,R as I}from"./vendor-C1mj56OW.js";import{u as E,a as R,b as P}from"./query-DpQl2WP_.js";import{c as F,a as B,b as z,g as M,X as T,F as O,h as q,i as W,e as V,S as $}from"./index-B96s3MY2.js";import{I as K}from"./input-D2DMLSl5.js";import{C as L,a as U}from"./card-Duc_CNra.js";import{D as Q,a as G,b as H,c as Z,d as Y,e as J}from"./dialog-DkidI4Qc.js";import{P as X}from"./plus-yq7vxH5Q.js";import{S as ee,T as se}from"./trash-2-CXSS_itr.js";import"./pdf-QG3cfAWJ.js";import"./charts-CWC3ycSS.js";
/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ae=F("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]),te=F("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),le=F("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]),ie=F("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),re=F("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]),ne=F("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]),de=z("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});
/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */function oe({className:s,variant:a,...t}){return e.jsx("div",{className:B(de({variant:a}),s),...t})}const ce=s,me=a,xe=D.forwardRef(({className:s,children:a,...i},r)=>e.jsxs(t,{ref:r,className:B("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",s),...i,children:[a,e.jsx(l,{asChild:!0,children:e.jsx(te,{className:"h-4 w-4 opacity-50"})})]}));xe.displayName=t.displayName;const he=D.forwardRef(({className:s,...a},t)=>e.jsx(i,{ref:t,className:B("flex cursor-default items-center justify-center py-1",s),...a,children:e.jsx(le,{className:"h-4 w-4"})}));he.displayName=i.displayName;const pe=D.forwardRef(({className:s,...a},t)=>e.jsx(r,{ref:t,className:B("flex cursor-default items-center justify-center py-1",s),...a,children:e.jsx(te,{className:"h-4 w-4"})}));pe.displayName=r.displayName;const ue=D.forwardRef(({className:s,children:a,position:t="popper",...l},i)=>e.jsx(n,{children:e.jsxs(d,{ref:i,className:B("relative z-50 max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]","popper"===t&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",s),position:t,...l,children:[e.jsx(he,{}),e.jsx(o,{className:B("p-1","popper"===t&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:a}),e.jsx(pe,{})]})}));ue.displayName=d.displayName;D.forwardRef(({className:s,...a},t)=>e.jsx(c,{ref:t,className:B("py-1.5 pl-8 pr-2 text-sm font-semibold",s),...a})).displayName=c.displayName;const je=D.forwardRef(({className:s,children:a,...t},l)=>e.jsxs(m,{ref:l,className:B("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),...t,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(x,{children:e.jsx(ae,{className:"h-4 w-4"})})}),e.jsx(h,{children:a})]}));je.displayName=m.displayName;function ge({isOpen:s,onClose:a,title:t,pdfPath:l}){const i=l&&l.endsWith(".pdf");return e.jsx(Q,{open:s,onOpenChange:a,children:e.jsxs(G,{className:"max-w-[95vw] w-full max-h-[95vh] h-[95vh] flex flex-col p-0",children:[e.jsx(H,{className:"flex-shrink-0 px-6 py-4 border-b",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(Z,{className:"text-lg font-semibold text-slate-900 truncate pr-4",children:t}),e.jsx(M,{variant:"ghost",size:"sm",onClick:a,className:"text-slate-400 hover:text-slate-600 hover:bg-slate-100",children:e.jsx(T,{className:"w-5 h-5"})})]})}),e.jsx("div",{className:"flex-1 overflow-hidden p-2",children:i?e.jsx("iframe",{src:`/api/pdfs/${l}`,className:"w-full h-full border-0 rounded-lg shadow-sm",title:t,style:{minHeight:"500px"}}):e.jsx("div",{className:"w-full h-full bg-slate-100 rounded-lg flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(O,{className:"w-16 h-16 text-slate-400 mx-auto mb-4"}),e.jsx("p",{className:"text-lg text-slate-600 mb-2",children:"PDF file not available"}),e.jsxs("p",{className:"text-sm text-slate-500",children:["File: ",l||"No file specified"]})]})})})]})})}D.forwardRef(({className:s,...a},t)=>e.jsx(p,{ref:t,className:B("-mx-1 my-1 h-px bg-muted",s),...a})).displayName=p.displayName;var be="AlertDialog",[fe,Ne]=u(be,[j]),ve=j(),ye=s=>{const{__scopeAlertDialog:a,...t}=s,l=ve(a);return e.jsx(C,{...l,...t,modal:!0})};ye.displayName=be;D.forwardRef((s,a)=>{const{__scopeAlertDialog:t,...l}=s,i=ve(t);return e.jsx(g,{...i,...l,ref:a})}).displayName="AlertDialogTrigger";var ke=s=>{const{__scopeAlertDialog:a,...t}=s,l=ve(a);return e.jsx(S,{...l,...t})};ke.displayName="AlertDialogPortal";var we=D.forwardRef((s,a)=>{const{__scopeAlertDialog:t,...l}=s,i=ve(t);return e.jsx(b,{...i,...l,ref:a})});we.displayName="AlertDialogOverlay";var _e="AlertDialogContent",[Ce,Se]=fe(_e),Ae=A("AlertDialogContent"),De=D.forwardRef((s,a)=>{const{__scopeAlertDialog:t,children:l,...i}=s,r=ve(t),n=D.useRef(null),d=f(a,n),o=D.useRef(null);return e.jsx(N,{contentName:_e,titleName:Ie,docsSlug:"alert-dialog",children:e.jsx(Ce,{scope:t,cancelRef:o,children:e.jsxs(v,{role:"alertdialog",...r,...i,ref:d,onOpenAutoFocus:y(i.onOpenAutoFocus,e=>{var s;e.preventDefault(),null==(s=o.current)||s.focus({preventScroll:!0})}),onPointerDownOutside:e=>e.preventDefault(),onInteractOutside:e=>e.preventDefault(),children:[e.jsx(Ae,{children:l}),e.jsx(Me,{contentRef:n})]})})})});De.displayName=_e;var Ie="AlertDialogTitle",Ee=D.forwardRef((s,a)=>{const{__scopeAlertDialog:t,...l}=s,i=ve(t);return e.jsx(k,{...i,...l,ref:a})});Ee.displayName=Ie;var Re="AlertDialogDescription",Pe=D.forwardRef((s,a)=>{const{__scopeAlertDialog:t,...l}=s,i=ve(t);return e.jsx(w,{...i,...l,ref:a})});Pe.displayName=Re;var Fe=D.forwardRef((s,a)=>{const{__scopeAlertDialog:t,...l}=s,i=ve(t);return e.jsx(_,{...i,...l,ref:a})});Fe.displayName="AlertDialogAction";var Be="AlertDialogCancel",ze=D.forwardRef((s,a)=>{const{__scopeAlertDialog:t,...l}=s,{cancelRef:i}=Se(Be,t),r=ve(t),n=f(a,i);return e.jsx(_,{...r,...l,ref:n})});ze.displayName=Be;var Me=({contentRef:e})=>{const s=`\`${_e}\` requires a description for the component to be accessible for screen reader users.\n\nYou can add a description to the \`${_e}\` by passing a \`${Re}\` component as a child, which also benefits sighted users by adding visible context to the dialog.\n\nAlternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${_e}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.\n\nFor more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return D.useEffect(()=>{var s;document.getElementById(null==(s=e.current)?void 0:s.getAttribute("aria-describedby"))},[s,e]),null},Te=we,Oe=De,qe=Fe,We=ze,Ve=Ee,$e=Pe;const Ke=ye,Le=ke,Ue=D.forwardRef(({className:s,...a},t)=>e.jsx(Te,{className:B("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...a,ref:t}));Ue.displayName=Te.displayName;const Qe=D.forwardRef(({className:s,...a},t)=>e.jsxs(Le,{children:[e.jsx(Ue,{}),e.jsx(Oe,{ref:t,className:B("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",s),...a})]}));Qe.displayName=Oe.displayName;const Ge=({className:s,...a})=>e.jsx("div",{className:B("flex flex-col space-y-2 text-center sm:text-left",s),...a});Ge.displayName="AlertDialogHeader";const He=({className:s,...a})=>e.jsx("div",{className:B("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",s),...a});He.displayName="AlertDialogFooter";const Ze=D.forwardRef(({className:s,...a},t)=>e.jsx(Ve,{ref:t,className:B("text-lg font-semibold",s),...a}));Ze.displayName=Ve.displayName;const Ye=D.forwardRef(({className:s,...a},t)=>e.jsx($e,{ref:t,className:B("text-sm text-muted-foreground",s),...a}));Ye.displayName=$e.displayName;const Je=D.forwardRef(({className:s,...a},t)=>e.jsx(qe,{ref:t,className:B(q(),s),...a}));Je.displayName=qe.displayName;const Xe=D.forwardRef(({className:s,...a},t)=>e.jsx(We,{ref:t,className:B(q({variant:"outline"}),"mt-2 sm:mt-0",s),...a}));function es({text:s,highlight:a}){if(!a)return e.jsx(e.Fragment,{children:s});const t=new RegExp(`(${a.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")})`,"gi"),l=s.split(t);return e.jsx(e.Fragment,{children:l.map((s,a)=>t.test(s)?e.jsx("mark",{style:{backgroundColor:"#bbf7d0",color:"inherit",borderRadius:"0.25rem",padding:"0 2px"},children:s},a):e.jsx(I.Fragment,{children:s},a))})}function ss(){var s,a;const t=W(),l="admin"===(null==t?void 0:t.level)||"petugas"===(null==t?void 0:t.level),[i,r]=D.useState(1),[n,d]=D.useState(25),[o,c]=D.useState(""),[m,x]=D.useState(),[h,p]=D.useState(),[u,j]=D.useState(""),[g,b]=D.useState(null),[f,N]=D.useState(!1),[v,y]=D.useState(!1),[k,w]=D.useState(!1),[_,C]=D.useState(!1),[S,A]=D.useState(!1),[I,F]=D.useState(null),[B,z]=D.useState({title:"",pengarang:"",penerbit:"",thn_buku:"",isbn:"",id_kategori:"",id_rak:"",tersedia:1,department:""}),[q,ae]=D.useState({title:"",pengarang:"",penerbit:"",thn_buku:"",isbn:"",id_kategori:void 0,id_rak:void 0,tersedia:1,department:""}),[te,le]=D.useState(null),{toast:de}=V(),he=E();D.useEffect(()=>{const e=setTimeout(()=>{r(1)},300);return()=>clearTimeout(e)},[o]),D.useEffect(()=>{r(1)},[n]),D.useEffect(()=>{r(1)},[n]);const{data:pe,isLoading:be}=R({queryKey:["/api/books",{page:i,limit:n,search:o,categoryId:m,rakId:h,departmentFilter:u}]}),{data:fe}=R({queryKey:["/api/categories"]}),{data:Ne}=R({queryKey:["/api/shelves"]}),{data:ve}=R({queryKey:["/api/departments"]}),ye=P({mutationFn:async e=>{const s=await fetch(`/api/books/${e}`,{method:"DELETE"});if(!s.ok)throw new Error("Failed to delete book");return s.json()},onSuccess:()=>{he.invalidateQueries({queryKey:["/api/books"]}),he.invalidateQueries({queryKey:["/api/dashboard/stats"]}),de({title:"Success",description:"Book deleted successfully"}),C(!1),F(null)},onError:()=>{de({title:"Error",description:"Failed to delete book",variant:"destructive"})}}),ke=P({mutationFn:async e=>{const s=new FormData;Object.keys(e.updates).forEach(a=>{const t=e.updates[a];null!=t&&""!==t&&s.append(a,t.toString())});for(let t of s.entries());const a=await fetch(`/api/books/${e.id}`,{method:"PATCH",body:s});if(!a.ok){const e=await a.text();throw new Error(`Failed to update book: ${a.status} ${e}`)}return a.json()},onSuccess:()=>{he.invalidateQueries({queryKey:["/api/books"]}),he.invalidateQueries({queryKey:["/api/dashboard/stats"]}),de({title:"Success",description:"Book updated successfully"}),w(!1),b(null)},onError:e=>{de({title:"Error",description:e.message||"Failed to update book",variant:"destructive"})}}),we=P({mutationFn:async e=>{const s=await fetch("/api/books",{method:"POST",body:e});if(!s.ok)throw new Error("Failed to create book");return s.json()},onSuccess:()=>{he.invalidateQueries({queryKey:["/api/books"]}),he.invalidateQueries({queryKey:["/api/dashboard/stats"]}),de({title:"Success",description:"Book added successfully"}),A(!1),ae({title:"",pengarang:"",penerbit:"",thn_buku:"",isbn:"",id_kategori:"0",id_rak:"0",tersedia:1,department:""}),le(null)},onError:e=>{de({title:"Error",description:e.message||"Failed to add book",variant:"destructive"})}}),_e=e=>{var s;const a=null==(s=e.lampiran)?void 0:s.replace(/^\/?pdfs\//,"");b({...e,lampiran:a??null}),N(!0)},Ce=(e,s)=>{z(a=>({...a,[e]:s}))},Se=(e,s)=>{ae(a=>({...a,[e]:""===s||"0"===s?void 0:s}))},Ae=Math.ceil(((null==pe?void 0:pe.total)||0)/n);return e.jsxs("div",{className:"min-h-screen",children:[e.jsx("div",{className:"bg-white border-b border-slate-200 px-6 py-4 sticky top-0 z-40",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900",children:"Document Repository"}),l&&e.jsxs(M,{onClick:()=>A(!0),className:"bg-primary text-white px-4 py-2 rounded-lg text-sm font-medium hover:bg-blue-700 transition-colors",children:[e.jsx(X,{className:"w-4 h-4 mr-2"}),"Add New Document"]})]})}),e.jsx("div",{className:"bg-white border-b border-slate-200 px-6 py-4 sticky top-16 z-30",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"flex-1 max-w-md",children:e.jsxs("div",{className:"relative",children:[e.jsx(K,{type:"text",placeholder:"Search books by title, author, publisher, or ISBN...",value:o,onChange:e=>{return s=e.target.value,c(s),void r(1);var s},className:"w-full pl-10 pr-10 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary"}),e.jsx(ne,{className:"absolute left-3 top-3 w-4 h-4 text-slate-400"}),o&&e.jsx("button",{onClick:()=>c(""),className:"absolute right-3 top-3 w-4 h-4 text-slate-400 hover:text-slate-600",children:e.jsx(T,{className:"w-4 h-4"})})]})}),e.jsxs(ce,{onValueChange:e=>{x("all"===e?void 0:parseInt(e)),r(1)},children:[e.jsx(xe,{className:"w-48",children:e.jsx(me,{placeholder:"All Categories"})}),e.jsxs(ue,{children:[e.jsx(je,{value:"all",children:"All Categories"}),null==fe?void 0:fe.map(s=>e.jsx(je,{value:s.id_kategori.toString(),children:s.nama_kategori},s.id_kategori))]})]}),e.jsxs(ce,{onValueChange:e=>{p("all"===e?void 0:parseInt(e)),r(1)},children:[e.jsx(xe,{className:"w-48",children:e.jsx(me,{placeholder:"All Shelves"})}),e.jsxs(ue,{children:[e.jsx(je,{value:"all",children:"All Shelves"}),null==Ne?void 0:Ne.map(s=>e.jsx(je,{value:s.id_rak.toString(),children:s.nama_rak},s.id_rak))]})]}),e.jsxs(ce,{onValueChange:e=>{j("all"===e?"":e),r(1)},children:[e.jsx(xe,{className:"w-48",children:e.jsx(me,{placeholder:"All Departments"})}),e.jsxs(ue,{children:[e.jsx(je,{value:"all",children:"All Departments"}),null==ve?void 0:ve.map(s=>e.jsx(je,{value:s.department,children:s.department},s.department))]})]}),(o||m||h||u)&&e.jsxs(M,{variant:"outline",onClick:()=>{c(""),x(void 0),p(void 0),j(""),r(1)},className:"flex items-center space-x-2",children:[e.jsx(re,{className:"w-4 h-4"}),e.jsx("span",{children:"Clear Filters"})]})]})}),e.jsx("div",{className:"p-6",children:e.jsx(L,{children:e.jsxs(U,{className:"p-0",children:[e.jsx("div",{className:"overflow-x-auto max-h-[calc(100vh-300px)] overflow-y-auto",children:e.jsxs("table",{className:"w-full min-w-full divide-y divide-slate-200",children:[e.jsx("thead",{className:"bg-slate-50 sticky top-0 z-10 shadow-sm",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider bg-slate-50",children:"Document"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider bg-slate-50",children:"Author"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider bg-slate-50",children:"Publisher"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider bg-slate-50",children:"Category"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider bg-slate-50",children:"Department"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider bg-slate-50",children:"Year"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider bg-slate-50",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider bg-slate-50",children:"PDF"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider bg-slate-50",children:"Location"}),l&&e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider bg-slate-50",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-slate-200",children:be?[...Array(n)].map((s,a)=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx($,{className:"h-14 w-10 rounded"}),e.jsxs("div",{className:"ml-4 space-y-2",children:[e.jsx($,{className:"h-4 w-48"}),e.jsx($,{className:"h-3 w-32"})]})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx($,{className:"h-4 w-24"})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx($,{className:"h-4 w-32"})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx($,{className:"h-4 w-20"})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx($,{className:"h-4 w-20"})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx($,{className:"h-4 w-12"})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx($,{className:"h-6 w-16 rounded-full"})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx($,{className:"h-8 w-8"})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx($,{className:"h-4 w-24"})}),l&&e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsx($,{className:"h-8 w-8"}),e.jsx($,{className:"h-8 w-8"})]})})]},a)):null==pe?void 0:pe.books.map(s=>e.jsxs("tr",{className:"hover:bg-slate-50 transition-colors",children:[e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"h-14 w-10 bg-red-50 rounded flex items-center justify-center flex-shrink-0 border border-red-200",children:e.jsx(O,{className:"w-6 h-6 text-red-600"})}),e.jsxs("div",{className:"ml-4 min-w-0 flex-1",children:[e.jsx("button",{onClick:()=>_e(s),className:"text-sm font-medium text-primary hover:text-blue-800 text-left block w-full",children:e.jsx("span",{className:"line-clamp-2 break-words",children:e.jsx(es,{text:s.title||"Untitled",highlight:o})})}),e.jsxs("p",{className:"text-sm text-slate-500 truncate",children:["ISBN: ",s.isbn||"N/A"]})]})]})}),e.jsx("td",{className:"px-6 py-4 text-sm text-slate-900",children:e.jsx("div",{className:"max-w-[150px] break-words line-clamp-2",children:e.jsx(es,{text:s.pengarang||"Unknown",highlight:o})})}),e.jsx("td",{className:"px-6 py-4 text-sm text-slate-900",children:e.jsx("div",{className:"max-w-[150px] break-words line-clamp-2",children:e.jsx(es,{text:s.penerbit||"Unknown",highlight:o})})}),e.jsx("td",{className:"px-6 py-4 text-sm text-slate-900",children:e.jsx("div",{className:"max-w-[120px] break-words",children:e.jsx(es,{text:s.kategori_nama||"Uncategorized",highlight:o})})}),e.jsx("td",{className:"px-6 py-4 text-sm text-slate-900",children:e.jsx("div",{className:"max-w-[120px] break-words",children:e.jsx(es,{text:s.department||"N/A",highlight:o})})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-slate-900",children:s.thn_buku||"N/A"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx(oe,{variant:1===s.tersedia?"default":"secondary",className:1===s.tersedia?"bg-green-100 text-green-800":"bg-red-100 text-red-800",children:1===s.tersedia?"Available":"On Loan"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-center",children:s.lampiran&&s.lampiran.endsWith(".pdf")?e.jsx(M,{variant:"ghost",size:"sm",onClick:()=>_e(s),title:"View PDF",className:"text-red-600 hover:text-red-800 hover:bg-red-50",children:e.jsx(O,{className:"w-5 h-5"})}):e.jsx("span",{className:"text-slate-400",children:e.jsx(O,{className:"w-5 h-5 opacity-30"})})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-slate-900",children:s.rak_nama||"Not assigned"}),l&&e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(M,{variant:"ghost",size:"sm",onClick:()=>(e=>{var s;b(e),z({title:e.title||"",pengarang:e.pengarang||"",penerbit:e.penerbit||"",thn_buku:(null==(s=e.thn_buku)?void 0:s.toString())||"",isbn:e.isbn||"",id_kategori:e.id_kategori?e.id_kategori.toString():"",id_rak:e.id_rak?e.id_rak.toString():"",tersedia:e.tersedia??1,department:e.department||""}),w(!0)})(s),className:"text-slate-600 hover:text-slate-800",title:"Edit Document",children:e.jsx(ee,{className:"w-4 h-4"})}),e.jsx(M,{variant:"ghost",size:"sm",onClick:()=>(e=>{F(e),C(!0)})(s),className:"text-red-600 hover:text-red-800",title:"Delete Document",children:e.jsx(se,{className:"w-4 h-4"})})]})})]},s.id_buku))})]})}),e.jsxs("div",{className:"bg-white px-6 py-3 border-t border-slate-200 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-sm text-slate-700",children:"Showing"}),e.jsxs(ce,{value:n.toString(),onValueChange:e=>d(parseInt(e)),children:[e.jsx(xe,{className:"w-20 h-8",children:e.jsx(me,{})}),e.jsxs(ue,{children:[e.jsx(je,{value:"25",children:"25"}),e.jsx(je,{value:"50",children:"50"}),e.jsx(je,{value:"100",children:"100"})]})]}),e.jsxs("span",{className:"text-sm text-slate-700",children:["of ",(null==pe?void 0:pe.total)||0," results"]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(M,{variant:"outline",size:"sm",onClick:()=>r(Math.max(1,i-1)),disabled:1===i,children:"Previous"}),e.jsxs("span",{className:"text-sm text-slate-700",children:["Page ",i," of ",Ae]}),e.jsx(M,{variant:"outline",size:"sm",onClick:()=>r(Math.min(Ae,i+1)),disabled:i===Ae,children:"Next"})]})]})]})})}),e.jsx(ge,{isOpen:f,onClose:()=>N(!1),pdfPath:(null==g?void 0:g.lampiran)||void 0,title:(null==g?void 0:g.title)||"Book PDF"}),e.jsx(Q,{open:v,onOpenChange:y,children:e.jsxs(G,{className:"sm:max-w-[600px] max-h-[80vh] overflow-y-auto",children:[e.jsxs(H,{children:[e.jsx(Z,{children:"Book Details"}),e.jsx(Y,{children:"Detailed information about the selected book."})]}),e.jsx("div",{className:"py-6 space-y-4",children:g&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsx("img",{src:g.sampul?`/uploads/${g.sampul}`:"/placeholder-book.jpg",alt:"Book cover",className:"h-32 w-24 object-cover rounded flex-shrink-0",onError:e=>{e.target.src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTUwIiBoZWlnaHQ9IjIwMCIgdmlld0JveD0iMCAwIDE1MCAyMDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIxNTAiIGhlaWdodD0iMjAwIiBmaWxsPSIjRjNGNEY2Ii8+CjxwYXRoIGQ9Ik01MCA2MEgxMDBWNzBINTBWNjBaIiBmaWxsPSIjOUNBM0FGIi8+CjxwYXRoIGQ9Ik0zMCA5MEgxMjBWMTAwSDMwVjkwWiIgZmlsbD0iIzlDQTNBRiIvPgo8cGF0aCBkPSJNNTAgMTIwSDEwMFYxMzBINTBWMTIwWiIgZmlsbD0iIzlDQTNBRiIvPgo8L3N2Zz4K"}}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900 break-words",children:g.title||"Untitled"}),e.jsxs("p",{className:"text-sm text-slate-600 break-words",children:["by ",g.pengarang||"Unknown Author"]}),e.jsx("div",{className:"flex items-center space-x-4",children:e.jsx(oe,{variant:1===g.tersedia?"default":"secondary",className:1===g.tersedia?"bg-green-100 text-green-800":"bg-red-100 text-red-800",children:1===g.tersedia?"Available":"On Loan"})})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Publisher"}),e.jsx("p",{className:"text-sm text-slate-900 p-2 bg-slate-50 rounded border break-words",children:g.penerbit||"Unknown"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Year"}),e.jsx("p",{className:"text-sm text-slate-900 p-2 bg-slate-50 rounded border",children:g.thn_buku||"N/A"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"ISBN"}),e.jsx("p",{className:"text-sm text-slate-900 p-2 bg-slate-50 rounded border break-all",children:g.isbn||"N/A"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Category"}),e.jsx("p",{className:"text-sm text-slate-900 p-2 bg-slate-50 rounded border",children:g.kategori_nama||"Uncategorized"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Shelf"}),e.jsx("p",{className:"text-sm text-slate-900 p-2 bg-slate-50 rounded border",children:g.rak_nama||"Not assigned"})]})]}),g.lampiran&&e.jsx("div",{className:"border-t pt-4",children:e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-blue-800",children:"PDF Available"}),e.jsx("p",{className:"text-sm text-blue-600",children:"Click to view the digital copy of this book"})]}),e.jsxs(M,{onClick:()=>{y(!1),_e(g)},className:"bg-blue-600 hover:bg-blue-700 text-white",size:"sm",children:[e.jsx(ie,{className:"w-4 h-4 mr-2"}),"View PDF"]})]})})]})}),e.jsx(J,{children:e.jsx(M,{variant:"outline",onClick:()=>y(!1),children:"Close"})})]})}),e.jsx(Q,{open:k,onOpenChange:w,children:e.jsxs(G,{className:"sm:max-w-[600px] max-h-[80vh] overflow-y-auto",children:[e.jsxs(H,{children:[e.jsx(Z,{children:"Edit Book"}),e.jsx(Y,{children:"Edit the selected book information. Click save when you're done."})]}),e.jsx("div",{className:"py-6 space-y-4",children:g&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Title *"}),e.jsx(K,{value:B.title,onChange:e=>Ce("title",e.target.value),placeholder:"Enter book title",className:"w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Author"}),e.jsx(K,{value:B.pengarang,onChange:e=>Ce("pengarang",e.target.value),placeholder:"Enter author name",className:"w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Publisher"}),e.jsx(K,{value:B.penerbit,onChange:e=>Ce("penerbit",e.target.value),placeholder:"Enter publisher",className:"w-full"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Year"}),e.jsx(K,{type:"number",value:B.thn_buku,onChange:e=>Ce("thn_buku",e.target.value),placeholder:"Enter publication year",className:"w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"ISBN"}),e.jsx(K,{value:B.isbn,onChange:e=>Ce("isbn",e.target.value),placeholder:"Enter ISBN",className:"w-full"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Category"}),e.jsxs(ce,{value:B.id_kategori||"",onValueChange:e=>Ce("id_kategori",e),children:[e.jsx(xe,{className:"w-full",children:e.jsx(me,{placeholder:"Select category"})}),e.jsxs(ue,{children:[e.jsx(je,{value:"0",children:"No Category"}),null==fe?void 0:fe.map(s=>e.jsx(je,{value:s.id_kategori.toString(),children:s.nama_kategori},s.id_kategori))]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Shelf"}),e.jsxs(ce,{value:B.id_rak||"",onValueChange:e=>Ce("id_rak",e),children:[e.jsx(xe,{className:"w-full",children:e.jsx(me,{placeholder:"Select shelf"})}),e.jsxs(ue,{children:[e.jsx(je,{value:"0",children:"No Shelf"}),null==Ne?void 0:Ne.map(s=>e.jsx(je,{value:s.id_rak.toString(),children:s.nama_rak},s.id_rak))]})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Availability Status"}),e.jsxs(ce,{value:(null==(s=B.tersedia)?void 0:s.toString())||"1",onValueChange:e=>Ce("tersedia",parseInt(e)),children:[e.jsx(xe,{className:"w-full",children:e.jsx(me,{placeholder:"Select availability"})}),e.jsxs(ue,{children:[e.jsx(je,{value:"1",children:"Available"}),e.jsx(je,{value:"0",children:"On Loan"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Department"}),e.jsx(K,{value:B.department,onChange:e=>Ce("department",e.target.value),placeholder:"Enter department",className:"w-full"})]})]})}),e.jsxs(J,{children:[e.jsx(M,{variant:"outline",onClick:()=>w(!1),disabled:ke.isPending,children:"Cancel"}),e.jsx(M,{onClick:()=>{if(!g)return;const e={};B.title&&(e.title=B.title),B.pengarang&&(e.pengarang=B.pengarang),B.penerbit&&(e.penerbit=B.penerbit),B.thn_buku&&(e.thn_buku=B.thn_buku),B.isbn&&(e.isbn=B.isbn),B.department&&(e.department=B.department),B.id_kategori&&"0"!==B.id_kategori&&(e.id_kategori=parseInt(B.id_kategori)),B.id_rak&&"0"!==B.id_rak&&(e.id_rak=parseInt(B.id_rak)),void 0!==B.tersedia&&(e.tersedia=B.tersedia),ke.mutate({id:g.id_buku,updates:e})},disabled:ke.isPending||!B.title,className:"bg-primary hover:bg-blue-700",children:ke.isPending?"Saving...":"Save Changes"})]})]})}),e.jsx(Ke,{open:_,onOpenChange:C,children:e.jsxs(Qe,{children:[e.jsxs(Ge,{children:[e.jsx(Ze,{children:"Are you sure?"}),e.jsxs(Ye,{children:["This action cannot be undone. This will permanently delete the book",e.jsxs("strong",{children:[' "',null==I?void 0:I.title,'"']})," from the library system."]})]}),e.jsxs(He,{children:[e.jsx(Xe,{children:"Cancel"}),e.jsx(Je,{onClick:()=>{I&&ye.mutate(I.id_buku)},className:"bg-red-600 hover:bg-red-700",disabled:ye.isPending,children:ye.isPending?"Deleting...":"Delete"})]})]})}),e.jsx(Q,{open:S,onOpenChange:A,children:e.jsxs(G,{className:"sm:max-w-[600px] max-h-[80vh] overflow-y-auto",children:[e.jsxs(H,{children:[e.jsx(Z,{children:"Add New Book"}),e.jsx(Y,{children:"Add a new book to the library system. Fill in the book information below."})]}),e.jsx("div",{className:"py-6 space-y-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Title *"}),e.jsx(K,{value:q.title,onChange:e=>Se("title",e.target.value),placeholder:"Enter book title",className:"w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Author"}),e.jsx(K,{value:q.pengarang,onChange:e=>Se("pengarang",e.target.value),placeholder:"Enter author name",className:"w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Publisher"}),e.jsx(K,{value:q.penerbit,onChange:e=>Se("penerbit",e.target.value),placeholder:"Enter publisher",className:"w-full"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Year"}),e.jsx(K,{type:"number",value:q.thn_buku,onChange:e=>Se("thn_buku",e.target.value),placeholder:"Enter publication year",className:"w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"ISBN"}),e.jsx(K,{value:q.isbn,onChange:e=>Se("isbn",e.target.value),placeholder:"Enter ISBN",className:"w-full"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Category"}),e.jsxs(ce,{value:q.id_kategori??"none",onValueChange:e=>Se("id_kategori","none"===e?void 0:e),children:[e.jsx(xe,{className:"w-full",children:e.jsx(me,{placeholder:"Select category"})}),e.jsxs(ue,{children:[e.jsx(je,{value:"none",children:"No Category"}),null==fe?void 0:fe.map(s=>e.jsx(je,{value:s.id_kategori.toString(),children:s.nama_kategori},s.id_kategori))]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Shelf"}),e.jsxs(ce,{value:q.id_rak??"none",onValueChange:e=>Se("id_rak","none"===e?void 0:e),children:[e.jsx(xe,{className:"w-full",children:e.jsx(me,{placeholder:"Select shelf"})}),e.jsxs(ue,{children:[e.jsx(je,{value:"none",children:"No Shelf"}),null==Ne?void 0:Ne.map(s=>e.jsx(je,{value:s.id_rak.toString(),children:s.nama_rak},s.id_rak))]})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Availability Status"}),e.jsxs(ce,{value:(null==(a=q.tersedia)?void 0:a.toString())||"1",onValueChange:e=>Se("tersedia",parseInt(e)),children:[e.jsx(xe,{className:"w-full",children:e.jsx(me,{placeholder:"Select availability"})}),e.jsxs(ue,{children:[e.jsx(je,{value:"1",children:"Available"}),e.jsx(je,{value:"0",children:"On Loan"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Department"}),e.jsx(K,{value:q.department,onChange:e=>Se("department",e.target.value),placeholder:"Enter department",className:"w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Attachment (PDF/Image)"}),e.jsx(K,{type:"file",accept:"application/pdf,image/*",onChange:e=>{var s;return le((null==(s=e.target.files)?void 0:s[0])||null)},className:"w-full"})]})]})}),e.jsxs(J,{children:[e.jsx(M,{variant:"outline",onClick:()=>A(!1),disabled:we.isPending,children:"Cancel"}),e.jsx(M,{onClick:()=>{if(!q.title)return;const e=new FormData;e.append("title",q.title),e.append("pengarang",q.pengarang),e.append("penerbit",q.penerbit),e.append("thn_buku",q.thn_buku||""),e.append("isbn",q.isbn),e.append("id_kategori",q.id_kategori||""),e.append("id_rak",q.id_rak||""),e.append("tersedia",q.tersedia.toString()),e.append("department",q.department),te&&e.append("lampiran",te),we.mutate(e)},disabled:we.isPending||!q.title,className:"bg-primary hover:bg-blue-700",children:we.isPending?"Adding...":"Add Book"})]})]})})]})}Xe.displayName=We.displayName;export{ss as default};
