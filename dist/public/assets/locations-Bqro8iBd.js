import{j as e}from"./ui-DM3Dsx1x.js";import{a,u as s,b as i}from"./query-DVbHB3bz.js";import{c as t,b as l,h as n,e as r,S as o,i as c}from"./index-X1rq4798.js";import{C as d,a as m}from"./card-p4qzoJ3G.js";import{I as x}from"./input-Da77kd2i.js";import{P as p,D as u,a as h,b as j,c as v,e as k}from"./dialog-xa4sHhbx.js";import{r as b}from"./vendor-C1mj56OW.js";import"./pdf-QG3cfAWJ.js";import"./charts-CWC3ycSS.js";
/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y=t("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);function f(){const{data:t,isLoading:f}=a({queryKey:["/api/locations"]}),N=s(),{toast:g}=l(),C=n(),E="admin"===(null==C?void 0:C.level),[S,w]=b.useState(!1),[L,_]=b.useState(!1),[q,D]=b.useState(null),[F,P]=b.useState(""),[A,z]=b.useState(""),[K,I]=b.useState(""),M=i({mutationFn:async e=>c("POST","/api/locations",{nama_lokasi:e.nama_lokasi,deskripsi:e.deskripsi||null,kapasitas:e.kapasitas?parseInt(e.kapasitas):null}),onSuccess:()=>{N.invalidateQueries({queryKey:["/api/locations"]}),w(!1),P(""),z(""),I(""),g({title:"Location added successfully"})},onError:()=>{g({title:"Failed to add location",variant:"destructive"})}}),O=i({mutationFn:async e=>c("PATCH",`/api/locations/${e.id}`,{nama_lokasi:e.nama_lokasi,deskripsi:e.deskripsi||null,kapasitas:e.kapasitas?parseInt(e.kapasitas):null}),onSuccess:()=>{N.invalidateQueries({queryKey:["/api/locations"]}),_(!1),D(null),P(""),z(""),I(""),g({title:"Location updated successfully"})},onError:()=>{g({title:"Failed to update location",variant:"destructive"})}}),Q=i({mutationFn:async e=>c("DELETE",`/api/locations/${e}`),onSuccess:()=>{N.invalidateQueries({queryKey:["/api/locations"]}),g({title:"Location deleted successfully"})},onError:()=>{g({title:"Failed to delete location",variant:"destructive"})}});return e.jsxs("div",{className:"min-h-screen",children:[e.jsx("div",{className:"bg-white border-b border-slate-200 px-6 py-4 sticky top-0 z-40",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(y,{className:"w-6 h-6 text-primary"}),e.jsx("h1",{className:"text-2xl font-bold text-slate-900",children:"Locations Management"})]}),E&&e.jsxs(r,{onClick:()=>{P(""),z(""),I(""),w(!0)},className:"bg-primary text-white px-4 py-2 rounded-lg text-sm font-medium hover:bg-blue-700 transition-colors",children:[e.jsx(p,{className:"w-4 h-4 mr-2"}),"Add Location"]})]})}),e.jsx("div",{className:"p-6",children:e.jsx(d,{children:e.jsx(m,{className:"p-6",children:f?e.jsx("div",{className:"space-y-4",children:[...Array(5)].map((a,s)=>e.jsxs("div",{className:"flex items-center justify-between p-4 border border-slate-200 rounded-lg",children:[e.jsx(o,{className:"h-4 w-48"}),e.jsx(o,{className:"h-8 w-20"})]},s))}):e.jsx("div",{className:"space-y-4",children:null==t?void 0:t.map(a=>e.jsxs("div",{className:"flex items-center justify-between p-4 border border-slate-200 rounded-lg hover:bg-slate-50 transition-colors",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-slate-900",children:a.nama_lokasi}),e.jsxs("p",{className:"text-sm text-slate-500",children:["Description: ",a.deskripsi||"Not specified"," â€¢ Capacity: ",a.kapasitas||"Unlimited"]})]}),E&&e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(r,{variant:"outline",size:"sm",onClick:()=>(e=>{var a;D(e),P(e.nama_lokasi),z(e.deskripsi||""),I((null==(a=e.kapasitas)?void 0:a.toString())||""),_(!0)})(a),children:"Edit"}),e.jsx(r,{variant:"outline",size:"sm",className:"text-red-600 hover:text-red-800",onClick:()=>(e=>{window.confirm("Are you sure you want to delete this location?")&&Q.mutate(e.id_lokasi)})(a),children:"Delete"})]})]},a.id_lokasi))})})})}),E&&e.jsx(u,{open:S,onOpenChange:w,children:e.jsxs(h,{children:[e.jsx(j,{children:e.jsx(v,{children:"Add New Location"})}),e.jsxs("div",{className:"space-y-4 mt-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Location Name *"}),e.jsx(x,{value:F,onChange:e=>P(e.target.value),placeholder:"Enter location name"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Description"}),e.jsx(x,{value:A,onChange:e=>z(e.target.value),placeholder:"Enter location description"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Capacity"}),e.jsx(x,{type:"number",value:K,onChange:e=>I(e.target.value),placeholder:"Enter capacity (optional)"})]})]}),e.jsx(k,{children:e.jsx(r,{onClick:()=>{F.trim()&&M.mutate({nama_lokasi:F,deskripsi:A,kapasitas:K})},disabled:M.isPending||!F.trim(),children:"Save"})})]})}),E&&e.jsx(u,{open:L,onOpenChange:_,children:e.jsxs(h,{children:[e.jsx(j,{children:e.jsx(v,{children:"Edit Location"})}),e.jsxs("div",{className:"space-y-4 mt-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Location Name *"}),e.jsx(x,{value:F,onChange:e=>P(e.target.value),placeholder:"Enter location name"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Description"}),e.jsx(x,{value:A,onChange:e=>z(e.target.value),placeholder:"Enter location description"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Capacity"}),e.jsx(x,{type:"number",value:K,onChange:e=>I(e.target.value),placeholder:"Enter capacity (optional)"})]})]}),e.jsx(k,{children:e.jsx(r,{onClick:()=>{q&&F.trim()&&O.mutate({id:q.id_lokasi,nama_lokasi:F,deskripsi:A,kapasitas:K})},disabled:O.isPending||!F.trim(),children:"Save"})})]})})]})}export{f as default};
