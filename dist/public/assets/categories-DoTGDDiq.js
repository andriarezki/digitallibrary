import{j as e}from"./ui-B2QfF1wH.js";import{a,u as s,b as t}from"./query-DpQl2WP_.js";import{e as i,i as r,g as l,S as n,j as o}from"./index-B96s3MY2.js";import{C as d,a as c}from"./card-Duc_CNra.js";import{D as m,a as u,b as x,c as p,e as g}from"./dialog-DkidI4Qc.js";import{r as h}from"./vendor-C1mj56OW.js";import{P as j}from"./plus-yq7vxH5Q.js";import"./pdf-QG3cfAWJ.js";import"./charts-CWC3ycSS.js";function y(){const{data:y,isLoading:v}=a({queryKey:["/api/categories"]}),f=s(),{toast:N}=i(),b=r(),C="admin"===(null==b?void 0:b.level),[k,w]=h.useState(!1),[S,_]=h.useState(!1),[E,F]=h.useState(null),[q,A]=h.useState(""),P=t({mutationFn:async e=>o("POST","/api/categories",e),onSuccess:()=>{f.invalidateQueries({queryKey:["/api/categories"]}),w(!1),A(""),N({title:"Category added successfully"})},onError:()=>{N({title:"Failed to add category",variant:"destructive"})}}),D=t({mutationFn:async e=>o("PATCH",`/api/categories/${e.id}`,{nama_kategori:e.nama_kategori}),onSuccess:()=>{f.invalidateQueries({queryKey:["/api/categories"]}),_(!1),F(null),A(""),N({title:"Category updated successfully"})},onError:()=>{N({title:"Failed to update category",variant:"destructive"})}}),K=t({mutationFn:async e=>o("DELETE",`/api/categories/${e}`),onSuccess:()=>{f.invalidateQueries({queryKey:["/api/categories"]}),N({title:"Category deleted successfully"})},onError:()=>{N({title:"Failed to delete category",variant:"destructive"})}});return e.jsxs("div",{className:"min-h-screen",children:[e.jsx("div",{className:"bg-white border-b border-slate-200 px-6 py-4 sticky top-0 z-40",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900",children:"Categories Management"}),C&&e.jsxs(l,{onClick:()=>{A(""),w(!0)},className:"bg-primary text-white px-4 py-2 rounded-lg text-sm font-medium hover:bg-blue-700 transition-colors",children:[e.jsx(j,{className:"w-4 h-4 mr-2"}),"Add Category"]})]})}),e.jsx("div",{className:"p-6",children:e.jsx(d,{children:e.jsx(c,{className:"p-6",children:v?e.jsx("div",{className:"space-y-4",children:[...Array(5)].map((a,s)=>e.jsxs("div",{className:"flex items-center justify-between p-4 border border-slate-200 rounded-lg",children:[e.jsx(n,{className:"h-4 w-48"}),e.jsx(n,{className:"h-8 w-20"})]},s))}):e.jsx("div",{className:"space-y-4",children:null==y?void 0:y.map(a=>e.jsxs("div",{className:"flex items-center justify-between p-4 border border-slate-200 rounded-lg hover:bg-slate-50 transition-colors",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-slate-900",children:a.nama_kategori}),e.jsxs("p",{className:"text-sm text-slate-500",children:["ID: ",a.id_kategori]})]}),C&&e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(l,{variant:"outline",size:"sm",onClick:()=>(e=>{F(e),A(e.nama_kategori),_(!0)})(a),children:"Edit"}),e.jsx(l,{variant:"outline",size:"sm",className:"text-red-600 hover:text-red-800",onClick:()=>(e=>{window.confirm("Are you sure you want to delete this category?")&&K.mutate(e.id_kategori)})(a),children:"Delete"})]})]},a.id_kategori))})})})}),C&&e.jsx(m,{open:k,onOpenChange:w,children:e.jsxs(u,{children:[e.jsx(x,{children:e.jsx(p,{children:"Add New Category"})}),e.jsx("input",{type:"text",className:"w-full border rounded px-3 py-2 mt-4",placeholder:"Category Name",value:q,onChange:e=>A(e.target.value)}),e.jsx(g,{children:e.jsx(l,{onClick:()=>{q.trim()&&P.mutate({nama_kategori:q})},disabled:P.isPending,children:"Save"})})]})}),C&&e.jsx(m,{open:S,onOpenChange:_,children:e.jsxs(u,{children:[e.jsx(x,{children:e.jsx(p,{children:"Edit Category"})}),e.jsx("input",{type:"text",className:"w-full border rounded px-3 py-2 mt-4",placeholder:"Category Name",value:q,onChange:e=>A(e.target.value)}),e.jsx(g,{children:e.jsx(l,{onClick:()=>{E&&q.trim()&&D.mutate({id:E.id_kategori,nama_kategori:q})},disabled:D.isPending,children:"Save"})})]})})]})}export{y as default};
