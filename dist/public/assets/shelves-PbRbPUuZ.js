import{j as a}from"./ui-B2QfF1wH.js";import{a as e,u as s,b as i}from"./query-DpQl2WP_.js";import{e as t,i as l,g as n,S as r,j as o}from"./index-B96s3MY2.js";import{C as d,a as c}from"./card-Duc_CNra.js";import{D as m,a as p,b as x,c as u,e as h}from"./dialog-DkidI4Qc.js";import{I as j}from"./input-D2DMLSl5.js";import{r as k}from"./vendor-C1mj56OW.js";import{P as v}from"./plus-yq7vxH5Q.js";import"./pdf-QG3cfAWJ.js";import"./charts-CWC3ycSS.js";function b(){const{data:b,isLoading:y}=e({queryKey:["/api/shelves"]}),f=s(),{toast:N}=t(),g=l(),_="admin"===(null==g?void 0:g.level)||"petugas"===(null==g?void 0:g.level),C="admin"===(null==g?void 0:g.level),[E,w]=k.useState(!1),[L,S]=k.useState(!1),[A,F]=k.useState(null),[q,D]=k.useState({nama_rak:"",lokasi:"",kapasitas:""}),P=i({mutationFn:async a=>o("POST","/api/shelves",{nama_rak:a.nama_rak,lokasi:a.lokasi||null,kapasitas:a.kapasitas?parseInt(a.kapasitas):null}),onSuccess:()=>{f.invalidateQueries({queryKey:["/api/shelves"]}),w(!1),D({nama_rak:"",lokasi:"",kapasitas:""}),N({title:"Location added successfully"})},onError:()=>{N({title:"Failed to add location",variant:"destructive"})}}),K=i({mutationFn:async a=>o("PATCH",`/api/shelves/${a.id}`,{nama_rak:a.nama_rak,lokasi:a.lokasi||null,kapasitas:a.kapasitas?parseInt(a.kapasitas):null}),onSuccess:()=>{f.invalidateQueries({queryKey:["/api/shelves"]}),S(!1),F(null),D({nama_rak:"",lokasi:"",kapasitas:""}),N({title:"Location updated successfully"})},onError:()=>{N({title:"Failed to update location",variant:"destructive"})}}),z=i({mutationFn:async a=>o("DELETE",`/api/shelves/${a}`),onSuccess:()=>{f.invalidateQueries({queryKey:["/api/shelves"]}),N({title:"Location deleted successfully"})},onError:()=>{N({title:"Failed to delete location",variant:"destructive"})}});return a.jsxs("div",{className:"min-h-screen",children:[a.jsx("div",{className:"bg-white border-b border-slate-200 px-6 py-4 sticky top-0 z-40",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("h1",{className:"text-2xl font-bold text-slate-900",children:"Location Management"}),_&&a.jsxs(n,{onClick:()=>{D({nama_rak:"",lokasi:"",kapasitas:""}),w(!0)},className:"bg-primary text-white px-4 py-2 rounded-lg text-sm font-medium hover:bg-blue-700 transition-colors",children:[a.jsx(v,{className:"w-4 h-4 mr-2"}),"Add Location"]})]})}),a.jsx("div",{className:"p-6",children:a.jsx(d,{children:a.jsx(c,{className:"p-6",children:y?a.jsx("div",{className:"space-y-4",children:[...Array(5)].map((e,s)=>a.jsxs("div",{className:"flex items-center justify-between p-4 border border-slate-200 rounded-lg",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(r,{className:"h-4 w-48"}),a.jsx(r,{className:"h-3 w-32"})]}),a.jsx(r,{className:"h-8 w-20"})]},s))}):a.jsx("div",{className:"space-y-4",children:null==b?void 0:b.map(e=>a.jsxs("div",{className:"flex items-center justify-between p-4 border border-slate-200 rounded-lg hover:bg-slate-50 transition-colors",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"font-medium text-slate-900",children:e.nama_rak}),a.jsxs("p",{className:"text-sm text-slate-500",children:["Location: ",e.lokasi||"Not specified"," â€¢ Capacity: ",e.kapasitas||"Unlimited"]})]}),C&&a.jsxs("div",{className:"flex space-x-2",children:[a.jsx(n,{variant:"outline",size:"sm",onClick:()=>(a=>{var e;F(a),D({nama_rak:a.nama_rak,lokasi:a.lokasi||"",kapasitas:(null==(e=a.kapasitas)?void 0:e.toString())||""}),S(!0)})(e),children:"Edit"}),a.jsx(n,{variant:"outline",size:"sm",className:"text-red-600 hover:text-red-800",onClick:()=>(a=>{window.confirm("Are you sure you want to delete this location?")&&z.mutate(a.id_rak)})(e),children:"Delete"})]})]},e.id_rak))})})})}),C&&a.jsx(m,{open:E,onOpenChange:w,children:a.jsxs(p,{children:[a.jsx(x,{children:a.jsx(u,{children:"Add New Location"})}),a.jsxs("div",{className:"space-y-4 mt-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Location Name *"}),a.jsx(j,{value:q.nama_rak,onChange:a=>D(e=>({...e,nama_rak:a.target.value})),placeholder:"Enter location name"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Address/Description"}),a.jsx(j,{value:q.lokasi,onChange:a=>D(e=>({...e,lokasi:a.target.value})),placeholder:"Enter location address or description"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Capacity"}),a.jsx(j,{type:"number",value:q.kapasitas,onChange:a=>D(e=>({...e,kapasitas:a.target.value})),placeholder:"Enter capacity (optional)"})]})]}),a.jsx(h,{children:a.jsx(n,{onClick:()=>{q.nama_rak.trim()&&P.mutate(q)},disabled:P.isPending,children:"Save"})})]})}),C&&a.jsx(m,{open:L,onOpenChange:S,children:a.jsxs(p,{children:[a.jsx(x,{children:a.jsx(u,{children:"Edit Location"})}),a.jsxs("div",{className:"space-y-4 mt-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Location Name *"}),a.jsx(j,{value:q.nama_rak,onChange:a=>D(e=>({...e,nama_rak:a.target.value})),placeholder:"Enter location name"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Address/Description"}),a.jsx(j,{value:q.lokasi,onChange:a=>D(e=>({...e,lokasi:a.target.value})),placeholder:"Enter location address or description"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Capacity"}),a.jsx(j,{type:"number",value:q.kapasitas,onChange:a=>D(e=>({...e,kapasitas:a.target.value})),placeholder:"Enter capacity (optional)"})]})]}),a.jsx(h,{children:a.jsx(n,{onClick:()=>{A&&q.nama_rak.trim()&&K.mutate({id:A.id_rak,...q})},disabled:K.isPending,children:"Save"})})]})})]})}export{b as default};
